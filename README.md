# Telegram бот для конвертации видео в текст

Бот для Telegram, который автоматически находит видео файлы в папках Яндекс.Диска, конвертирует их в аудио и транскрибирует в текст через Whisper.

## Функциональность

1. **Поиск видео** - Автоматически находит все видео файлы в указанной папке Яндекс.Диска (рекурсивно)
2. **Скачивание** - Скачивает видео файлы с Яндекс.Диска
3. **Конвертация** - Конвертирует видео в аудио (WAV, 16kHz, моно)
4. **Транскрибация** - Извлекает текст из аудио через Whisper
5. **Отправка** - Отправляет текстовые файлы пользователю в Telegram

## Требования

### Системные зависимости

**FFmpeg** - требуется для конвертации видео в аудио

**Windows:**
```bash
# Скачайте с https://ffmpeg.org/download.html
# Или через chocolatey:
choco install ffmpeg
```

**Linux:**
```bash
sudo apt-get update
sudo apt-get install ffmpeg
```

**macOS:**
```bash
brew install ffmpeg
```

### Python зависимости

Установите зависимости:
```bash
pip install -r requirements.txt
```

## Настройка

1. Откройте `config.py`
2. Укажите `BOT_TOKEN` - токен бота от @BotFather
3. Укажите `YANDEX_DISK_TOKEN` - OAuth токен Яндекс.Диска
4. Укажите `ADMIN_IDS` - список ID администраторов

## Запуск

### Локальный запуск

```bash
python main.py
```

### Запуск через Docker

#### 1. Сборка образа

```bash
docker build -t yandex-disk-bot .
```

#### 2. Запуск контейнера

```bash
docker run -d \
  --name yandex-disk-bot \
  --restart unless-stopped \
  -v $(pwd)/config.py:/app/config.py:ro \
  yandex-disk-bot
```

#### 3. Запуск через docker-compose (рекомендуется)

```bash
docker-compose up -d
```

#### 4. Просмотр логов

```bash
docker-compose logs -f
```

или

```bash
docker logs -f yandex-disk-bot
```

#### 5. Остановка

```bash
docker-compose down
```

или

```bash
docker stop yandex-disk-bot
docker rm yandex-disk-bot
```

## Использование

1. Отправьте боту ссылку на папку Яндекс.Диска
2. Бот автоматически:
   - Найдет все видео файлы
   - Скачает их
   - Конвертирует в аудио
   - Транскрибирует через Whisper
   - Отправит текстовые файлы

## Поддерживаемые форматы видео

- `.mp4`, `.avi`, `.mov`, `.mkv`, `.wmv`, `.flv`, `.webm`, `.m4v`, `.3gp`, `.mpg`, `.mpeg`

## Модели Whisper

По умолчанию используется модель `base`. Доступные модели:
- `tiny` - самая быстрая, низкое качество
- `base` - баланс скорости и качества (рекомендуется)
- `small` - лучшее качество, медленнее
- `medium` - высокое качество, очень медленно
- `large` - максимальное качество, очень медленно

Изменить модель можно в `handlers/disk_handler.py`:
```python
transcription_service = TranscriptionService(model_size="base")
```

## Примечания

- Бот работает только для администраторов
- Транскрибация может занять время в зависимости от размера видео
- Временные файлы автоматически удаляются после обработки
- Для больших видео файлов процесс может занять значительное время

